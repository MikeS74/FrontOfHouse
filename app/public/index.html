<!DOCTYPE html>
<html>

<head>
    <title>Front of House</title>
    <link rel="stylesheet" href="static/assets/css/minimal-form.css" />
    <link rel="stylesheet" href="static/assets/css/list-results.css" />
</head>

<body>
    <!-- Upper left Bar of links (Write a review, Company) -->

    <!-- Upper right Login link -->

    <!-- Recent Reviews -->

    <!-- Top Places (on the left) Worst Places (on the right) -->

    <!-- User input field -->
    <div id="search-bar-div" class="form-group">
        <form id="form" class="topBefore">
            <header>SEARCH BUSINESS:</header>
            <input class="input-bar typeahead" id="user-input" type="text" placeholder="NAME">

            <!-- Search button -->
            <input class="input-search" id="run-search" type="submit" value="SEARCH">
        </form>
    </div>
    
    <div id="list-view">
    
    
    </div>
    
    <script src="https://code.jquery.com/jquery.js"></script>
    
<script type="text/javascript">
    
     $("#run-search").on("click", function(event) {
     event.preventDefault();
         
     var search = $("#user-input").val().trim();
         
     $("#search-bar-div").hide();
         
     var queryURL = "https://developers.zomato.com/api/v2.1/search?q=" + search + "&lat=34.0353061&lon=-118.3794192&radius=13%2C000" + "&apikey=abf456dfeacd356e5b295aa8cb32a4a6";
         
     $.ajax({
         url: queryURL,
         method: "GET"
     }).done(function(response) {
         var results = response.restaurants;
         
         for (var i = 0; i < results.length; i++) {
             var listDiv = $("<div class='list-gen'>");
             var restResults = response.restaurants[i];
             var restName = restResults.restaurant.name;
             var restLoc = restResults.restaurant.location.address;
             var restRating = restResults.restaurant.user_rating.aggregate_rating;
             var restID = restResults.restaurant.id;
             var dispAll = $("<p class='rest-list-item'>").html(restName + "<br>" + restLoc + "<br>" + "Customer Rating: " + restRating + "<br>").attr({
                 "data-zomato-id": restID,
                 "data-zomato-name": restName,
                 "data-zomato-loc": restLoc
             });
             listDiv.append(dispAll);
             $("#list-view").append(listDiv);
         };
         
         $(".rest-list-item").on("click", function(event) {
             var newReview = {
                 api_id: $(this).attr("data-zomato-id"),
                 business_name: $(this).attr("data-zomato-name"),
                 business_loc: $(this).attr("data-zomato-loc")
             };
             $.ajax("/api/reviews", {
                 type: "POST",
                 data: newReview
             }).then(function() {
                 console.log(newReview);
             });
         });
     });
 });
</script>

    <!-- Links and credit -->

    <!-- jQuery JS -->
   
    <!-- jqeury link -->
    <script src ="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.js"></script>
    
    <!--typehead link -->
    <script src ="https://cdnjs.cloudflare.com/ajax/libs/typeahead.js/0.11.1/typeahead.jquery.js"></script>
    
    <!-- bloodhound link -->
    <script src ="https://cdnjs.cloudflare.com/ajax/libs/corejs-typeahead/1.2.1/bloodhound.js"></script>

    <!-- Code to the JavaScript File -->
    <script src="static/assets/js/autocomplete.js"></script>
    <script src="static/assets/js/reviews.js"></script>
    
</body>

</html>